import bb.cascades 1.0
//import CustomTimer 1.0

// A page used to present a list of cities for a specific continent.
// The real data is managed in code and read from an SQL database.

NavigationPane {
    id: puzzleNav
    Page {
        id: playPuzzlePage
        actions: [
            ActionItem {
                title: "New Puzzle"
                ActionBar.placement: ActionBarPlacement.OnBar
                onTriggered: {
                    wordsPlus.intializePlayArea();
                    puzzleTimer.start();
                    //run animation instead
                    mysteryContainer.opacity = 1;
                    doubleTapLabel.opacity = 1;
                    revealedPuzzleWords.text = "";
                }
            },
            ActionItem {
                title: "Category"
                ActionBar.placement: ActionBarPlacement.OnBar
                onTriggered: {
                    categorySheet.open();
                    puzzleTimer.stop();
                    playPuzzleRootContainer.currentCount = 0;
                }
            }
        ]
        Container {
            id: playPuzzleRootContainer
            horizontalAlignment: HorizontalAlignment.Center
            background: Color.Black
            preferredWidth: 768
            property int currentCount: 0
            //            Timer {
            //                id: puzzleTimer
            //
            //                // Specify a timeout interval of 1 second
            //                interval: 1000
            //                onTimeout: {
            //                    // Decrement the counter and update the countdown text
            //                    playPuzzleRootContainer.currentCount += 1;
            //                    timerDisplay.text = "" + playPuzzleRootContainer.currentCount;
            //
            //                    // When the counter reaches 0, change the traffic light
            //                    // state, stop the countdown timer, and start the pause
            //                    // timer
            //                    if (playPuzzleRootContainer.currentCount == 10) {
            //                        timerDisplay.text = "Done!";
            //                        puzzleTimer.stop();
            //                        playPuzzleRootContainer.currentCount = 0;
            //                    }
            //                } // end of onTimeout signal handler
            //            } // end of Timer
            Container {
                horizontalAlignment: HorizontalAlignment.Center
                verticalAlignment: VerticalAlignment.Center
                Label {
                    text: "Puzzle."
                    textStyle {
                        base: textNormalWhite.style
                    }
                }
            }
            Container { // divider
                preferredWidth: 600
                preferredHeight: 3
                background: Color.create("#ff8c00")
                verticalAlignment: VerticalAlignment.Center
                horizontalAlignment: HorizontalAlignment.Center
            }
            Container {
                layout: DockLayout {
                }
                preferredWidth: 720
                horizontalAlignment: HorizontalAlignment.Center
                Container {
                    horizontalAlignment: HorizontalAlignment.Left
                    //                    Label {
                    //                        text: "time: "
                    //                        textStyle {
                    //                            base: subTitleNormalWhite.style
                    //                        }
                    //                    }
                    Label {
                        id: timerDisplay
                        text: "TIME: " + "0:00"
                        textStyle {
                            base: subTitleNormalWhite.style
                        }
                    }
                }
                Container {
                    horizontalAlignment: HorizontalAlignment.Right
                    Label {
                        text: "SCORE: " + "2734555"
                        textStyle {
                            base: subTitleNormalWhite.style
                        }
                    }
                }
            }
            Container {
                objectName: "playAreaContainer"
                layout: StackLayout {
                    orientation: LayoutOrientation.LeftToRight
                }
                topMargin: 30
                preferredWidth: 700
                preferredHeight: preferredWidth
                horizontalAlignment: HorizontalAlignment.Center
            }         
            Container { // Container for words to find
                topMargin: 50
                objectName: "wordsToFind"
                layout: StackLayout {
                    orientation: LayoutOrientation.LeftToRight
                }
                preferredWidth: 720
                horizontalAlignment: HorizontalAlignment.Center
            }
            //            Container {
            //                topMargin: 40
            //                horizontalAlignment: HorizontalAlignment.Center
            //                Container {
            //                    layout: DockLayout {
            //                    }
            //                    preferredWidth: 720
            //                    horizontalAlignment: HorizontalAlignment.Center
            //                    Container {
            //                        id: mysteryContainer
            //                        verticalAlignment: VerticalAlignment.Center
            //                        horizontalAlignment: HorizontalAlignment.Center
            //                        background: Color.create("#0098f0")
            //                        preferredHeight: 100
            //                        preferredWidth: 720
            //                        opacity: 1
            //                    }
            //                    Label {
            //                        id: revealedPuzzleWords
            //                        verticalAlignment: VerticalAlignment.Center
            //                        horizontalAlignment: HorizontalAlignment.Center
            //                        preferredWidth: 720
            //                        text: wordsPlus.puzzleWords
            //                        multiline: true
            //                        textStyle.base: subTitleNormalBlue.style
            //                    }
            //                    Label {
            //                        id: doubleTapLabel
            //                        verticalAlignment: VerticalAlignment.Center
            //                        horizontalAlignment: HorizontalAlignment.Center
            //                        text: "Double Tap to reveal"
            //                        multiline: true
            //                        textStyle.base: subTitleNormalWhite.style
            //                    }
            //                    gestureHandlers: [
            //                        DoubleTapHandler {
            //                            onDoubleTapped: { //set this up as animation fade out and fade in
            //                                mysteryContainer.opacity = 0
            //                                doubleTapLabel.opacity = 0
            //                            }
            //                        }
            //                    ]
            //                }
            //            } // Container
        } // Page
        attachedObjects: [
            TextStyleDefinition {
                id: textNormalWhite
                base: SystemDefaults.TextStyles.BigText
                color: Color.create("#fafafa")
            },
            TextStyleDefinition {
                id: subTitleNormalWhite
                base: SystemDefaults.TextStyles.SubtitleText
                fontWeight: FontWeight.Normal
                fontFamily: "Times New Roman"
                color: Color.create("#fafafa")
            },
            TextStyleDefinition {
                id: subTitleNormalBlue
                base: SystemDefaults.TextStyles.SubtitleText
                fontWeight: FontWeight.Normal
                fontFamily: "Times New Roman"
                color: Color.create("#0098f0")
            },
            Sheet {
                id: categorySheet
                Page {
                    Container {
                        background: Color.Black
                        layout: DockLayout {
                        }
                        Container {
                            background: Color.create("#272727")
                            preferredWidth: 720
                            preferredHeight: 400
                            verticalAlignment: VerticalAlignment.Top
                            horizontalAlignment: HorizontalAlignment.Center
                            layout: AbsoluteLayout {
                            }
                            Label {
                                text: "Pick your Word List Type"
                                textStyle {
                                    color: Color.create("#fafafa")
                                    base: SystemDefaults.TextStyles.TitleText
                                }
                                layoutProperties: AbsoluteLayoutProperties {
                                    positionX: 20
                                    positionY: 20
                                }
                            }
                            RadioGroup {
                                id: radioGroup
                                layoutProperties: AbsoluteLayoutProperties {
                                    positionX: 20
                                    positionY: 75
                                }
                                Option {
                                    id: radioOptionCategory
                                    selected: true
                                }
                                Option {
                                    id: radioOptionLocation
                                }
                                onSelectedIndexChanged: {
                                    if (radioOptionCategory.selected == true) {
                                        byCategory.visible = true;
                                        byCategory.opacity = 1;
                                        byLocation.opacity = 0;
                                    }
                                    if (radioOptionLocation.selected == true) {
                                        byLocation.opacity = 1;
                                        byCategory.opacity = 0;
                                        byCategory.visible = false; //added to avoid issue with overlapping
                                    }
                                }
                            }
                            Label {
                                layoutProperties: AbsoluteLayoutProperties {
                                    positionX: 120
                                    positionY: 100
                                }
                                text: "By Category"
                                textStyle {
                                    color: Color.create("#fafafa")
                                    base: SystemDefaults.TextStyles.BodyText
                                }
                            }
                            Label {
                                layoutProperties: AbsoluteLayoutProperties {
                                    positionX: 120
                                    positionY: 240
                                }
                                text: "By Location"
                                textStyle {
                                    color: Color.create("#fafafa")
                                    base: SystemDefaults.TextStyles.BodyText
                                }
                            }
                        }
                        Container {
                            id: byLocation
                            topPadding: 50
                            preferredWidth: 720
                            background: Color.create("#272727")
                            horizontalAlignment: HorizontalAlignment.Center
                            verticalAlignment: VerticalAlignment.Bottom
                            opacity: 0
                            ToggleButton {
                            }
                            TextArea {
                                text: "By Location wordsearch is an awesome new way to play wordsearh. " + "Now there's no limit to the number of different words you can search!"
                                editable: false
                                textStyle {
                                    base: SystemDefaults.TextStyles.BodyText
                                    color: Color.create("#555555")
                                }
                            }
                            TextArea {
                                text: "Location Services must be turned ON for this feature to work correctly"
                                editable: false
                                textStyle {
                                    base: SystemDefaults.TextStyles.SmallText
                                    color: Color.create("#0098f0")
                                }
                            }
                        }
                        Container {
                            id: byCategory
                            topPadding: 50
                            preferredWidth: 720
                            background: Color.create("#272727")
                            horizontalAlignment: HorizontalAlignment.Center
                            verticalAlignment: VerticalAlignment.Bottom
                            opacity: 1
                            TextArea {
                                id: textField
                                text: "Current category: " + wordsPlus.category
                                editable: false
                                textStyle {
                                    base: SystemDefaults.TextStyles.SubtitleText
                                    color: Color.create("#0098f0")
                                }
                            }
                            ListView {
                                dataModel: XmlDataModel {
                                    source: "models/categories.xml"
                                }                             
                                preferredHeight: 500
                                listItemComponents: [
                                    ListItemComponent {
                                        type: "listItem"
                                        Container {
                                            layout: StackLayout {
                                                orientation: LayoutOrientation.LeftToRight
                                            }
                                            Label {
                                                text: ListItemData.title
                                                textStyle.color: Color.create("#fafafa")
                                            }
                                        } // end of Container
                                    } // end of second ListItemComponent
                                ] // end of listItemComponents list

                                // When an item is selected, update the text in the TextField
                                // to display the status of the new item
                                onTriggered: {
                                    var selectedItem = dataModel.data(indexPath);
                                    wordsPlus.category = selectedItem.filename;
                                    textField.text = "Current category: " + wordsPlus.category;
                                }
                            } // end of ListView
                        }
                    }
                    actions: [
                        ActionItem {
                            title: "Close"
                            ActionBar.placement: ActionBarPlacement.OnBar

                            // When this action is selected, close
                            // the sheet
                            onTriggered: {
                                wordsPlus.intializePlayArea();
                                categorySheet.close();
                                puzzleTimer.start();
                            }
                        }
                    ]
                }
            }
        ]
    } //end of page
}// end of nav
